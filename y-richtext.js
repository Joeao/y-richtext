!function t(e,o,r){function n(s,u){if(!o[s]){if(!e[s]){var p="function"==typeof require&&require;if(!u&&p)return p(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+s+"'")}var l=o[s]={exports:{}};e[s][0].call(l.exports,function(t){var o=e[s][1][t];return n(o?o:t)},l,l.exports,t,e,o,r)}return o[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)n(r[s]);return n}({1:[function(t,e,o){var r,n,i,s={}.hasOwnProperty,u=function(t,e){function o(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};r=function(){function t(t){this.editor=t}return t.prototype.getContents=function(){throw new Error("Implement me")},t.prototype.getCursor=function(){throw new Error("Implement me")},t.prototype.setCursor=function(t){throw new Error("Implement me")},t.prototype.observeLocalText=function(t){throw new Error("Implement me")},t.prototype.observeLocalCursor=function(t){throw new Error("Implement me")},t.prototype.updateContents=function(t){throw new Error("Implement me")},t}(),n=function(t){function e(t){this.editor=t,e.__super__.constructor.call(this,this.editor),this._cursors=this.editor.getModule("multi-cursor")}return u(e,t),e.prototype.getCursorPosition=function(){var t;return t=this.editor.getSelection(),t?t.start:0},e.prototype.getContents=function(){return this.editor.getContents()},e.prototype.setCursor=function(t){return this._cursors.setCursor(t.id,t.index,t.text,t.color)},e.prototype.observeLocalText=function(t){return this.editor.on("text-change",function(e,o){return t(e),console.log(e)})},e.prototype.observeLocalCursor=function(t){return this.editor.on("selection-change",function(e,o){return console.log("api"===o?"changed by backend":"changed by user"),e&&e.start===e.end?(t(e.start),console.log(e.start)):void 0})},e.prototype.updateContents=function(t){return this.editor.updateContents(t)},e}(r),i=function(t){function e(t){this.editor=t,e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.getCursorPosition=function(){return 0},e.prototype.getContents=function(){return{ops:[{insert:"Well, this is a test!"},{insert:"And I'm boldâ€¦",attributes:{bold:!0}}]}},e.prototype.setCursor=function(){return""},e.prototype.observeLocalText=function(t){return""},e.prototype.observeLocalCursor=function(t){return""},e.prototype.updateContents=function(t){return""},e}(r),o.QuillJs=n,o.TestEditor=i},{}],2:[function(t,e,o){var r;r=function(){function t(){this._tmp_model={}}return t.prototype._get=function(t){return null==this._model?this._tmp_model[t]:this._model.val(t)},t.prototype._set=function(t,e){return null==this._model?this._tmp_model[t]=e:this._model.val(t,e)},t.prototype._getModel=function(t,e){var o,r,n;if(null==this._model){this._model=new e.MapManager(this).execute(),n=this._tmp_model;for(o in n)r=n[o],this._model.val(o,r)}return this._model},t.prototype._setModel=function(t){return this._model=t,delete this._tmp_model},t}(),"undefined"!=typeof e&&null!==e&&(o.BaseClass=r)},{}],3:[function(t,e,o){var r,n,i,s=function(t,e){return function(){return t.apply(e,arguments)}},u={}.hasOwnProperty,p=function(t,e){function o(){this.constructor=t}for(var r in e)u.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};if(r=t("./misc.coffee").BaseClass,n=t("./editors.coffee"),i=function(t){function e(){this.updateCursorPosition=s(this.updateCursorPosition,this),this.passDeltas=s(this.passDeltas,this),this.lock_editor_propagation=!1}var o,r,i;return p(e,t),e.prototype.bind=function(t,e){var o,r,i,s,u,p,l,c;if(o=n[t],null!=o){for(this.editor=new o(e),this.editor.editor.deleteText(0,this.editor.editor.getText().length),this.editor.updateContents({ops:[{insert:this._get("characters").val().join("")}]}),r=0,u=[],c=this._get("selections").getSelections(this._get("characters")),p=0,l=c.length;l>p;p++)i=c[p],s=i.to-i.from,r!==i.from&&u.push({retain:i.from-r}),u.push({retain:s,attributes:i.attrs}),r+=s;return this.editor.updateContents({ops:u}),this.editor.observeLocalText(this.passDeltas),this.bindEventsToEditor(this.editor),this.editor.observeLocalCursor(this.updateCursorPosition)}throw new Error("This type of editor is not supported!")},e.prototype._getModel=function(t,o){return null==this._model&&(e.__super__._getModel.apply(this,arguments),this._set("selections",new t.Selections),this._set("characters",new t.List),this._set("cursors",new t.Object),this._setModel(this._model),this._model.observe(this.propagateToEditor)),this._model},e.prototype._setModel=function(t){return e.__super__._setModel.apply(this,arguments)},e.prototype._name="RichText",e.prototype.setCursor=function(t){return this.selfCursor=this._get("characters").ref(t),this._get("cursors").val(this._model.HB.getUserId(),this.selfCursor)},e.prototype.passDeltas=function(t){var e,o,r,n;if(!this.lock_editor_propagation){for(this.lock_editor_propagation=!0,o=0,r=0,n=t.length;n>r;r++)e=t[r],o=this.deltaHelper(e,o);return this.lock_editor_propagation=!1}},e.prototype.updateCursorPosition=function(t){return this.lock_editor_propagation?void 0:(this.lock_editor_propagation=!0,this.selfCursor="number"==typeof t?this._get("characters").ref(t):t,this._get("cursors").val(this._model.HB.getUserId(),this.selfCursor),this.lock_editor_propagation=!1)},e.prototype.bindEventsToEditor=function(t){return this._get("characters").observe(function(t){return function(e){var o,r,n,i;if(!t.lock_editor_propagation){for(t.lock_editor_propagation=!0,n=0,i=e.length;i>n;n++)r=e[n],o={ops:[{retain:r.position}]},"insert"===r.type?o.ops.push({insert:r.value}):"delete"===r.type&&o.ops.push({"delete":1}),t.editor.updateContents(o);return t.lock_editor_propagation=!1}}}(this)),this._get("selections").observe(function(t){return function(e){var o,r,n,i,s,u,p,l,c;if(!t.lock_editor_propagation){if(t.lock_editor_propagation=!0,r={},"select"===e.type){l=e.attrs;for(o in l)s=l[o],r[o]=s}else for(c=e.attrs,u=0,p=c.length;p>u;u++)o=c[u],r[o]=null;return n=e.from.getPosition(),i=e.to.getPosition()-e.from.getPosition(),t.editor.updateContents({ops:[{retain:n},{retain:i,attributes:r}]}),t.lock_editor_propagation=!1}}}(this)),this._get("cursors").observe(function(t){return function(e){var o,r,n,i,s,u;if(!t.lock_editor_propagation){for(t.lock_editor_propagation=!0,s=0,u=e.length;u>s;s++)r=e[s],o=r.changedBy,i=r.object.val(o),null!==i&&(n={id:o,index:r.object.val(o).getPosition(),text:o,color:"grey"},t.editor.setCursor(n));return t.lock_editor_propagation=!1}}}(this))},r=function(t,o){var r,n,i,s,u,p,l,c,a;if(null==o&&(o=0),null!=t){p=e._get("selections"),n=[],r={},a=t.attributes;for(s in a)c=a[s],null!=c?r[s]=c:n.push(s);if(null!=t.insert)return e.insertHelper(o,t.insert),i=e._get("characters").ref(o),l=e._get("characters").ref(o+t.insert.length),e._get("selections").select(i,l,r),e._get("selections").unselect(i,l,n),o+t.insert.length;if(null!=t["delete"])return e.deleteHelper(o,t["delete"]),o;if(null!=t.retain)return u=parseInt(t.retain),i=e._get("characters").ref(o),l=e._get("characters").ref(o+u),e._get("selections").select(i,l,r),e._get("selections").unselect(i,l,n),o+u;throw new Error("This part of code must not be reached!")}},i=function(t,o){var r;return r="string"==typeof o?o.split(""):"number"==typeof o?[o]:void 0,null!=r?e._get("characters").insertContents(t,r):void 0},o=function(t,o){return null==o&&(o=1),console.log("deleteHelper"),e._get("characters")["delete"](t,o)},e}(r),"undefined"!=typeof window&&null!==window){if(null==window.Y)throw new Error("You must first import Y!");window.Y.RichText=i}"undefined"!=typeof e&&null!==e&&(e.exports=i)},{"./editors.coffee":1,"./misc.coffee":2}]},{},[3]);